<html lang="en"></html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no" />
    <link rel="icon" href="images/favicon.png" type="image/png" />
    <title>covid-19 in Viet Nam</title>

    <!-- Load the Chart.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.30/esri/themes/light/main.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://js.arcgis.com/4.30/"></script>

    <script>
      require([
        "esri/views/MapView",
        "esri/WebMap",
        "esri/widgets/Legend",
        "esri/widgets/Expand",
        "esri/widgets/Bookmarks",
        "esri/core/lang",
        "esri/core/promiseUtils",
        "esri/core/reactiveUtils"
      ], (MapView, WebMap, Legend, Expand, Bookmarks, lang, promiseUtils, reactiveUtils) => {

        let yearChart, ageChart, dispositionChart, genderChart, raceChart, totalNumber, avgAge, avgOpenTime;
        const webmap = new WebMap({
          portalItem: {
            id: "1e254684c9bd41259e296eea06a0b1b0"
          }
        });

        const view = new MapView({
          map: webmap,
          container: "viewDiv",
        });
        const titleContent = document.createElement("div");
        titleContent.style.padding = "15px";
        titleContent.style.backgroundColor = "white";
        titleContent.style.width = "350px";
        titleContent.innerHTML = [
          "<div id='title' class='esri-widget'>",
          "<span id='num-homicides'>0</span> homicides occurred within one mile of the pointer location over the last 10 years.",
          "The average age of the victims is <span id='avg-age'>0</span>. The average time an unsolved case has been",
          "open is <span id='avg-open-time'>0</span> years.",
          "</div>"
        ].join(" ");

        const titleExpand = new Expand({
          expandIcon: "dashboard",
          expandTooltip: "Summary stats",
          view: view,
          content: titleContent,
          expanded: view.widthBreakpoint !== "xsmall",
          placement: "left-start",
          group: "top-right"
        });
        view.ui.add(titleExpand, "top-right");

        const legendExpand = new Expand({
          view: view,
          content: new Legend({
            view: view
          }),
          expanded: view.widthBreakpoint !== "xsmall",
        });
        view.ui.add(legendExpand, "bottom-left");

        reactiveUtils.watch(
          () => view.widthBreakpoint,
          (widthBreakpoint) => {
            titleExpand.expanded = widthBreakpoint !== "xsmall";
            legendExpand.expanded = widthBreakpoint !== "xsmall";
          }
        );

        const bookmarksWidget = new Bookmarks({
          view: view
        });

        const bookmarksExpand = new Expand({
          view: view,
          content: bookmarksWidget,
          group: "top-right"
        });
        view.ui.add(bookmarksExpand, "top-right");

        bookmarksWidget.on("select-bookmark", (event) => {
          bookmarksExpand.expanded = false;
        });

        const sampleInstructions = document.createElement("div");
        sampleInstructions.style.padding = "10px";
        sampleInstructions.style.backgroundColor = "white";
        sampleInstructions.style.width = "300px";
        sampleInstructions.innerHTML = [
          "<b>Drag</b> the pointer over the data to view stats",
          "within one mile of the pointer location."
        ].join(" ");

        const instructionsExpand = new Expand({
          expandIcon: "question",
          expandTooltip: "How to use this sample",
          view: view,
          content: sampleInstructions
        });
        view.ui.add(instructionsExpand, "top-left");

        let highlightHandle = null;

      });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
    <div id="panel">
      <div style="padding: 15px">
        <canvas id="year-chart" height="250" width="550"></canvas>
        <canvas id="age-chart" height="250" width="550"></canvas>
        <canvas id="disposition-chart" width="200" height="350" style="float: left"></canvas>
        <canvas id="gender-chart" width="200" height="350" style="float: left"></canvas>
        <canvas id="race-chart" width="200" height="350" style="float: left"></canvas>
      </div>
    </div>
  </body>
</html>